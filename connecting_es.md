---

copyright:
  years: 2015, 2022
lastupdated: "2022-04-27"

keywords: IBM Event Streams, Kafka as a service, managed Apache Kafka

subcollection: EventStreams

---

{:external: target="_blank" .external}
{:shortdesc: .shortdesc}
{:screen: .screen}
{:codeblock: .codeblock}
{:pre: .pre}
{:note: .note}


# Connecting to {{site.data.keyword.messagehub}}
{: #connecting}

The way how you connect to {{site.data.keyword.messagehub}} varies depending on whether your application is running natively or as a Cloud Foundry application. However, in both cases two pieces of information are required: 
{: shortdesc}

- The endpoint URLs for the APIs.
- Credentials for authentication.

Read the following information about how to obtain these details. Ensure that you complete the appropriate steps for your instance.

## Overview
{: #connect_enterprise}

Services that are provisioned using the Standard or the Enterprise plans are grouped in the dashboard under the heading **Services**. The plans are [IAM enabled](/docs/account?topic=account-overview){: external}. You don't need to understand IAM to get started but some knowledge is recommended if you want to secure your {{site.data.keyword.messagehub}} service. For more information, see [Managing access to your {{site.data.keyword.messagehub}} resources](/docs/EventStreams?topic=EventStreams-security).

Complete the following steps to bind your application and obtain Service Keys for your service. To be authorized to create topics, your application or Service Key must have a Manager access role.

To connect an application, the method that is used depends on where the application is deployed, that is in Cloud Foundry or deployed outside Cloud Foundry, for example in the Kubernetes Service.

## Provision an {{site.data.keyword.messagehub}} instance
{: #provision_instance}

As a prerequisite, you must first provision an {{site.data.keyword.messagehub}} service instance for either the Standard or Enterprise plan. Next, obtain {{site.data.keyword.messagehub}} API connection details by completing the following tasks.

## Connect applications 
{: #connect_enterprise_external}

For applications that run outside Cloud Foundry, credentials are generated by creating a service key. When you obtain the service key, manually pass the details of the key to your application by using your chosen method.

### Get credentials by using the IBM Cloud console
{: #connect_enterprise_external_console}

1. Locate your {{site.data.keyword.messagehub}} service on the dashboard.
2. Click your service tile.
3. Click **Service Credentials**.
4. Click **New Credential**. 
5. Complete the details for your new credential like a name and role and click **Add**. A new credential appears in the credentials list.
6. Click this credential using **View Credentials** to reveal the details in JSON format.
7. Pass these credentials to your application. Specify `token` as your user name and the <api_key> as your password. Separate `token` and the <api_key> with a colon. For more information, see [Configuring your Kafka API client](/docs/EventStreams?topic=EventStreams-kafka_using#kafka_api_client).

    Ensure that your application parses the details.

### Get credentials by using the IBM Cloud CLI
{: #connect_enterprise_external_cli}

1. Locate your service: `ibmcloud resource service-instances`
2. Create a service key: `ibmcloud resource service-key-create <key_name> <key_role> --instance-name <your_service_name>`
3. Print the service key: `ibmcloud resource service-key <key_name>`
4. Pass these credentials to your application. Specify `token` as your username and the <api_key> as your password. Separate `token` and the <api_key> with a colon. For more information, see [Configuring your client](/docs/EventStreams?topic=eventstreams-kafka_api_client).

    Ensure that your application parses the details.

The endpoints in the service key are generated according to the service endpoints settings of the instance. For example, public endpoints are generated for `--service-endpoints=public`, and private endpoints are generated for `--service-endpoints=private`. However, for an instance that has `--service-endpoints=public-and-private`, public endpoints are generated by default. To generate private endpoints in the service key, use the following command: 

```text
ibmcloud resource service-key-create <private-key-name> <role> --instance-name <instance-name> --service-endpoint private.
```
{: codeblock}
  
## Connect Cloud Foundry applications
{: #connect_enterprise_cf}

Your application must be bound to the {{site.data.keyword.messagehub}} service instance. To bind a Cloud Foundry application to a non-Cloud Foundry service, create a Cloud Foundry service alias first and then reference this alias from your Cloud Foundry application when binding. 

When bound, the connection details are then made available to the application in JSON format using the VCAP_SERVICES environment variable. You can bind an application and service by using either the [IBM Cloud console](/docs/EventStreams?topic=EventStreams-connecting#connect_enterprise_cf_console) or the [IBM Cloud CLI](/docs/EventStreams?topic=EventStreams-connecting#connect_enterprise_cf_cli).

### Bind an application by using the IBM Cloud console
{: #connect_enterprise_cf_console}

1. Ensure that you are in the intended Cloud Foundry Organization and Space.
2. Locate your Cloud Foundry Application on the dashboard or create an application by clicking **Create resource**.
3. Click your application tile.
4. Click **Connections**.
5. Click **Create Connection**.
6. Select the {{site.data.keyword.messagehub}} service tile that you want to bind to and click **Connect**. 
7. In the **Connect IAM-Enabled Service** window that appears, select an access role from **Access Role for Connection** and a service ID from the **Service ID for Connection** list (you can accept the auto-generated ID). Click **Connect**. 

    This step creates a Cloud Foundry service alias for your {{site.data.keyword.messagehub}} service and then binds your application to this alias.    \n    \n 

    Restage your application for the changes to take effect.
8. Click the **Runtime** tab on the left and select the **Environment variables** tab in the center. You can now verify your VCAP_SERVICES information. Your application can now access these variables as environment variables. 

### Bind an application by using the IBM Cloud CLI
{: #connect_enterprise_cf_cli}

1. Ensure that you are in the intended Cloud Foundry Organization and Space. You can navigate interactively by running the following command:
    `ibmcloud target --cf`
2. Locate your app:
    `ibmcloud app list`

    If you have a manifest file, you can create a new app by running the following command:

    `ibmcloud app push`

    Because the app is not bound to {{site.data.keyword.messagehub}} yet, the app cannot establish a connection. Therefore, push the application with the `--no-start` parameter to avoid unnecessary connection failures.
3. Locate your service:
    `ibmcloud resource service-instances`
4. Create a Cloud Foundry service alias:
    `ibmcloud resource service-alias-create <alias_name> --instance-name <your_service_name>`
5. Bind your app to the service alias created previously:

    `ibmcloud service bind <your_ app_name> <alias_name>`.

    Alternatively, you can update your manifest file and push the application again.
6. Verify that the VCAP_SERVICES environment variable is available in your application runtime:
    `ibmcloud app env <your_app_name>`
7. Pass these credentials to your application. Specify `token` as your username and the <api_key> as your password. Separate `token` and the <api_key> with a colon. For more information, see [Configuring your client](/docs/EventStreams?topic=EventStreams-kafka_api_client). 

    You might need to restage your application for the changes to take effect.


## What to do next
{: #after_connecting}

Now you have connection and credential information, you can choose an {{site.data.keyword.messagehub}} client. For more information, see [Using the Kafka API](/docs/EventStreams?topic=EventStreams-kafka_using).


